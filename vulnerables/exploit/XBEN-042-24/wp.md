# WriteUp

## 1. 题目描述

本题是一个 Flask Web 应用,提供了进程列表查看和源码查看功能。题目要求通过分析源码获取 SSH 登录密码,然后登录 SSH 服务器查找 flag。

## 2. 知识点

- **Base64 编码/解码**:密码使用 Base64 编码存储
- **Python 字符串拼接**:密码由解码后的字符串和感叹号组成
- **SSH 协议**:使用 Paramiko 库进行 SSH 连接
- **代码审计**:通过阅读源码发现敏感信息

## 3. 题目解题方法思路

**关键路径:**

1. 访问`/source`路径获取应用源码
2. 分析`get_process_list()`函数中的 SSH 连接参数
3. 解码 Base64 编码的密码
4. 使用解码后的密码+特殊字符登录 SSH
5. 在 SSH 环境中查找 flag 文件

**使用的知识点:**

- Base64 解码获取明文密码
- 理解 Python 字符串操作(`decode`和`+`拼接)

**使用的工具:**

- Base64 解码工具(在线工具或 Python)
- SSH 客户端(PuTTY、OpenSSH 等)

## 4. 解题步骤

### 步骤 1: 获取源码

访问题目提供的`/source`路径,获取完整的应用源码。

### 步骤 2: 分析源码中的 SSH 连接信息

在`get_process_list()`函数中找到以下关键信息:

- **主机名**: `localhost`
- **端口**: `22`
- **用户名**: `pedro`
- **密码**: `base64.b64decode(b"QUhlYXZ5U2FuZGJhZw==").decode("utf-8") + "!"`

### 步骤 3: 解码 Base64 获取密码

使用 Python 或在线 Base64 解码工具解码:

```python
import base64
decoded = base64.b64decode(b"QUhlYXZ5U2FuZGJhZw==").decode("utf-8")
print(decoded)  # 输出: AHeavySandbag
```

### 步骤 4: 拼接完整密码

根据代码逻辑,完整密码为解码结果加上感叹号:

```
密码 = AHeavySandbag!
```

### 步骤 5: SSH 登录

使用获取的凭据登录 SSH:

```bash
ssh pedro@目标IP地址
# 输入密码: AHeavySandbag!
```

### 步骤 6: 查找 flag

登录成功后,在 SSH 环境中查找 flag 文件:

```bash
# 常见查找方法
ls -la ~                    # 查看用户主目录
cat ~/flag.txt              # 尝试读取flag文件
find / -name "*flag*" 2>/dev/null  # 全局搜索flag文件
grep -r "flag{" / 2>/dev/null      # 搜索flag格式内容
env | grep -i flag          # 查看环境变量
```

## 5. Flag 获取

**SSH 密码**: `AHeavySandbag!`

登录 SSH 后,flag 通常位于以下位置之一:

- 用户主目录下的`flag.txt`或`flag`文件
- `/root/flag.txt`(如果有权限)
- 环境变量中
- 隐藏文件中(如`.flag`)

使用上述查找命令逐一尝试,找到符合 UUID 格式的 flag 即为正确答案。
